<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Hub - Windows 2000 Edition</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <a class="skip-link" href="#main-lobby">Skip to lobby content</a>
    <div class="profile-corner classic-raised win2k-window win2k-window--floating" id="profile-corner" role="button" aria-haspopup="dialog" aria-controls="identity-overlay" aria-expanded="false" aria-label="Open profile preferences" tabindex="0">
        <img id="profile-avatar" src="/images/default-avatar.svg" alt="Player avatar" class="profile-avatar">
        <div class="profile-stats">
            <div class="profile-name" id="profile-display-name">Guest</div>
            <div class="profile-meta">Wins: <span id="profile-wins">0</span></div>
        </div>
        <span class="profile-corner__hint" aria-hidden="true">Preferences</span>
    </div>

    <div class="app-container">
        <header class="header">
            <div class="window">
                <div class="title-bar">
                    <span class="title-bar-text">Game Hub Control Center</span>
                    <div class="title-bar-controls">
                        <button type="button" class="title-bar-btn" aria-label="Minimize" tabindex="-1">_</button>
                        <button type="button" class="title-bar-btn" aria-label="Maximize" tabindex="-1">□</button>
                        <button type="button" class="title-bar-btn" aria-label="Close" tabindex="-1">×</button>
                    </div>
                </div>
                <div class="window-body">
                    <h1 class="intro-text">Welcome to Game Hub</h1>
                    <p class="tagline">A lightweight, local-first platform for classic games with authentic Windows 2000 styling.</p>
                </div>
            </div>
        </header>

        <aside class="lobby-list" aria-label="Available games">
            <div class="window" style="height: 100%;">
                <div class="title-bar">
                    <span class="title-bar-text">Available LAN Games</span>
                </div>
                <div class="window-body lobby-body">
                    <div class="classic-sunken lobby-scroll">
                        <div id="room-list">
                            <p class="text-muted">No open games found. Create one!</p>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <main class="left-panels">
            <section id="main-lobby" class="window" aria-labelledby="main-lobby-title">
                <div class="title-bar">
                    <span class="title-bar-text" id="main-lobby-title">Player Setup &amp; Quick Actions</span>
                </div>
                <div class="window-body">
                    <p id="name-greeting" class="name-greeting">Welcome, <span id="player-name-preview">Guest</span>!</p>

                    <div class="identity-cta" aria-live="polite">
                        <p class="identity-cta__description">Open your profile preferences to update your display name, avatar, and account.</p>
                        <button id="open-identity-overlay-btn" class="btn btn-secondary" type="button">Open Profile Preferences</button>
                    </div>

                    <div class="window-section classic-raised" aria-labelledby="p2p-title">
                        <h2 id="p2p-title">Play Online (P2P)</h2>
                        <p>Enter a shared, secret room code to connect directly with a friend over the internet.</p>
                        <label for="online-room-code" class="sr-only">Room code</label>
                        <div class="input-row">
                            <input type="text" id="online-room-code" placeholder="Enter Room Code..." class="input-field" autocomplete="off">
                            <button id="join-online-btn" class="btn btn-primary" type="button">Join</button>
                        </div>
                    </div>

                    <div class="window-section classic-raised" aria-labelledby="lan-title">
                        <h2 id="lan-title">Play on Local WiFi</h2>
                        <p>Create or join a game with others on the same network.</p>
                        <div class="input-row">
                            <button id="show-available-games-btn" class="btn btn-secondary" type="button">View Available Games</button>
                            <button id="show-create-game-modal-btn" class="btn btn-primary" type="button">Create New Game</button>
                        </div>
                    </div>
                </div>
            </section>

            <section id="match-lobby" class="window hidden" aria-labelledby="match-lobby-title">
                <div class="title-bar">
                    <span class="title-bar-text" id="match-lobby-title">Match Lobby</span>
                </div>
                <div class="window-body">
                    <h1 id="match-lobby-gametype" class="window-heading">Game Lobby</h1>
                    <p>The game will begin when the host starts the match.</p>

                    <div class="match-lobby classic-sunken" role="list">
                        <div class="player-card classic-raised" id="player1-card" role="listitem">
                            <p class="player-name">Player 1 (Host)</p>
                            <p id="player1-status" class="status not-ready">Not Ready</p>
                        </div>
                        <div class="player-card classic-raised" id="player2-card" role="listitem">
                            <p class="player-name">Waiting for Player...</p>
                            <p id="player2-status" class="status not-ready">Not Ready</p>
                        </div>
                    </div>
                    <div class="match-controls">
                        <button id="ready-btn" class="btn btn-warning" type="button">Ready Up</button>
                        <button id="start-game-btn" class="btn btn-primary hidden" type="button" disabled>Start Game</button>
                        <button id="leave-room-btn" class="btn btn-secondary" type="button">Leave Room</button>
                    </div>
                </div>
            </section>

            <section id="game-ui" class="window hidden" aria-labelledby="game-session-title">
                <div class="title-bar">
                    <span class="title-bar-text" id="game-session-title">Game Session</span>
                </div>
                <div class="window-body">
                    <div id="game-info-bar" class="classic-raised" role="status">
                        <div>
                            <p>Mode: <b id="game-mode"></b></p>
                            <p>Your Color: <b id="player-color"></b></p>
                        </div>
                        <h2 id="turn-indicator" aria-live="assertive"></h2>
                    </div>
                    <div id="scoreboard" class="scoreboard classic-raised hidden" aria-live="assertive">
                        <p id="score-text">Red: 0 – Black: 0</p>
                    </div>
                    <div class="game-stage" data-component="game-board">
                        <div id="game-container" class="classic-sunken" role="application" aria-label="Game board"></div>
                        <p class="game-stage__meta">The board adapts automatically to your screen size.</p>
                    </div>
                    <div class="match-controls" aria-label="Game actions">
                        <button id="pause-game-btn" class="btn btn-secondary" type="button">Pause (ESC)</button>
                        <button id="exit-to-menu-btn" class="btn" type="button">Exit to Menu</button>
                    </div>
                    <div id="pause-menu" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="pause-menu-title" tabindex="-1">
                        <div class="modal-content classic-raised">
                            <div class="title-bar">
                                <span class="title-bar-text" id="pause-menu-title">Game Paused</span>
                            </div>
                            <div class="modal-body">
                                <p>The game is paused. Other players can still see the board.</p>
                                <div class="modal-actions">
                                    <button id="resume-game-btn" class="btn btn-primary" type="button">Resume (ESC)</button>
                                    <button id="pause-exit-to-menu-btn" class="btn btn-warning" type="button">Exit to Lobby</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="game-over-message" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="winner-text" tabindex="-1">
                        <div class="modal-content classic-raised">
                            <h1 id="winner-text"></h1>
                            <button id="game-over-exit-btn" class="btn btn-primary" type="button">Back to Lobby</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="footer" role="contentinfo">
            <div class="window">
                <div class="title-bar">
                    <span class="title-bar-text">Server Status</span>
                </div>
                <div class="window-body status-body">
                    <div class="status-indicator online" role="status">Online</div>
                    <div class="status-message" aria-live="polite" role="status">Local multiplayer services are running.</div>
                    <div class="network-info" aria-live="polite" role="status">
                        IP: <span id="server-ip">Loading…</span> • URL: <span id="server-url">Loading…</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <div id="create-game-modal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="create-game-title" tabindex="-1">
        <div class="modal-content classic-raised">
            <div class="title-bar">
                <span class="title-bar-text" id="create-game-title">Create a New Game</span>
            </div>
            <div class="modal-body">
                <p>Choose a game to host on the local network.</p>
                <div id="game-selection-list" class="selection-list"></div>
                <div class="modal-actions">
                    <button id="close-modal-btn" class="btn" type="button">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div id="identity-overlay" class="modal-overlay hidden identity-overlay" role="dialog" aria-modal="true" aria-labelledby="identity-overlay-title" tabindex="-1">
        <div class="modal-content classic-raised identity-modal">
            <div class="title-bar">
                <span class="title-bar-text" id="identity-overlay-title">Profile Preferences</span>
                <div class="title-bar-controls">
                    <button type="button" class="title-bar-btn" id="close-identity-overlay-btn" aria-label="Close profile preferences">×</button>
                </div>
            </div>
            <div class="modal-body identity-modal__body">
                <div class="profile-preferences" role="document">
                    <section class="profile-preferences__header">
                        <div class="profile-preferences__avatar">
                            <img id="profile-avatar-preview" src="/images/default-avatar.svg" alt="Profile avatar preview" class="profile-avatar profile-avatar--large">
                            <button id="change-avatar-btn" class="btn btn-secondary" type="button">Change Avatar</button>
                            <form id="avatar-upload-form" class="hidden" enctype="multipart/form-data">
                                <input type="file" id="avatar-upload-input" name="avatar" accept="image/*">
                                <input type="hidden" name="_csrf" id="csrf-token">
                            </form>
                        </div>
                        <div class="profile-preferences__summary">
                            <h2 class="profile-preferences__name" id="profile-overlay-display-name">Guest</h2>
                            <p class="profile-preferences__wins">Wins: <span id="profile-overlay-wins">0</span></p>
                        </div>
                    </section>

                    <section class="identity-modal__section" aria-labelledby="identity-section-title">
                        <h3 id="identity-section-title">Display Name</h3>
                        <p>Choose the name that will appear in match lobbies and scoreboards.</p>
                        <label for="identity-display-name" class="input-label">Display name</label>
                        <input type="text" id="identity-display-name" class="input-field" placeholder="Enter your display name..." maxlength="24" autocomplete="name">
                        <p id="identity-status" class="name-status hidden" role="status"></p>
                        <div class="modal-actions identity-modal__actions">
                            <button id="identity-save-btn" class="btn btn-primary" type="button">Save Name</button>
                            <button id="identity-cancel-btn" class="btn" type="button">Cancel</button>
                        </div>
                    </section>

                    <section class="identity-modal__section" aria-labelledby="account-section-title">
                        <h3 id="account-section-title">Account</h3>
                        <p>Sign in to sync progress or sign out to switch players.</p>
                        <div class="identity-modal__actions identity-modal__actions--account">
                            <button id="sign-in-btn" class="btn btn-secondary" type="button">Sign In</button>
                            <button id="sign-out-btn" class="btn btn-warning hidden" type="button">Sign Out</button>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <div id="profile-prompt-modal" class="modal-overlay hidden prompt-modal" role="dialog" aria-modal="true" aria-labelledby="profile-prompt-title" tabindex="-1">
        <div class="modal-content classic-raised">
            <div class="title-bar">
                <span class="title-bar-text" id="profile-prompt-title">Complete Your Profile</span>
            </div>
            <div class="modal-body">
                <p id="profile-prompt-message">It looks like your profile is missing a display name or avatar. Update your profile to unlock the full experience.</p>
                <div class="modal-actions">
                    <button id="prompt-edit-profile-btn" class="btn btn-primary" type="button">Edit Profile</button>
                    <button id="prompt-dismiss-btn" class="btn" type="button">Maybe Later</button>
                </div>
            </div>
        </div>
    </div>

    <div id="available-games-modal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="available-games-title" tabindex="-1">
        <div class="modal-content classic-raised" style="max-width: 600px;">
            <div class="title-bar">
                <span class="title-bar-text" id="available-games-title">Available LAN Games</span>
                <div class="title-bar-controls">
                    <button type="button" class="title-bar-btn" id="close-available-games-btn" aria-label="Close available games">×</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="lobby-scroll" style="max-height: 400px; overflow-y: auto;">
                    <div id="modal-room-list">
                        <p class="text-muted">No open games found. Create one!</p>
                    </div>
                </div>
                <div class="modal-actions">
                    <button id="close-available-games-modal-btn" class="btn" type="button">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div id="global-loading" class="win2k-loading hidden" role="status" aria-live="polite">
        <span class="win2k-loading__bar" aria-hidden="true"></span>
        <span>Loading game assets…</span>
    </div>

    <div id="toast-container" class="toast-container" aria-live="polite" aria-atomic="false"></div>

    <script src="/socket.io/socket.io.js"></script>
    <script type="module" src="/js/main.js"></script>
</body>
</html>
